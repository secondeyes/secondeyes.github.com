---
layout: post
title:  "에러를 대하는 개발자의 자세"
description: "어느 쥬니어 개발자의 "
author: secondeyes
date:   2017-03-03 16:10:09 +0900
categories: develop
published: true
---

안녕하세요. 우아한형제들 배민B2C개발팀에서 주문시스템을 개발하고 있는 정용준입니다. <br/>
저는 우아한형제들 개발인턴 1기로 이곳에서 개발을 시작하였고 지금까지 다양한 경험을 하고 있습니다.

## 목표달성 
> '2017년 7월 안에 우아한형제들 기술블로그에 글을 올려보자!'

개인적으로 올해 상반기 안에 기술블로그에 글을 올려보고 싶다는 목표를 가지고 있었습니다.<br/>
기술적인 내용을 공유하기에는 부족한 부분이 많아 포기하고 있었는데, 최근 한 이슈를 해결하는 과정에서 느낀점을 공유해보는 것이 의미있을 것 같았습니다. (이사님의 제안도 있었구요^^)<br/> 

사실, 주제를 정하는 것부터 쉽지 않았는데요 (글을 썼다 지웠다 반복한 시간이 꽤 지났습니다.)<br/>
이곳이 대단한 기술적인 내용을 공유하는 것, 전혀 몰랐던 새로운 지식을 공유하는 공간만이 아닌 우아한형제들의 일원으로 한 개인이 성장하는 모습들을 담은 곳이기에 "우아한형제들 성장일기"에 저도 한걸음 보태보고 싶었습니다.<br/>

무엇보다 저같이 개발을 시작한지 얼마 되지 않은 쥬니어 개발자들이 겪고 있을 상황을 공감하고<br/> 
그 안에서 스스로에게 던진 질문을 통해서 개인이 성장할 수 있는 방향을 생각해 볼 수 있다면 의미가 있겠구나 생각도 들었습니다.<br/>

## 에러를 대하는 개발자의 자세
제가 이야기 해보고 싶은 내용은 <strong>"에러를 대하는 (쥬니어)개발자의 자세"</strong> 입니다.<br/> 
(주제부터 뭔가.... 테크니컬해보이진 않죠? 굳이 쥬니어 라는 prefix를 붙일 필요도 없어 보이긴 하지만요 ㅎㅎ) <br/>

개발자에게 에러는.. ~와도 같죠<br/>
<strong>장애/에러/이슈가 발생하면 어떠신가요들?</strong>
![code_work]({{ site.url }}/img/2017-03-04/junior_03.jpg){: style="width:50%; display:block; border:1px solid #021a40; margin:20px auto 0;"}
*[내가 짠 코드가 어떻게 동작하는지도 모르겠는데...]*{: style="display:block;margin-top:10px;color:#828282;font-style:normal;text-align:center"}

갑자기 장애가 발생하면 정말 당황스럽고, 안그래도 할일이 많은데.. 짜증나지 않나요?<br/>
간헐적으로 발생하는 이슈가 있으면 당장에는 '아.. 그래도 큰 장애는 아니라서 다행이야' 라는 생각이 들면서도.. <br/>
아.. 뭔가 나중에 쓰나미가 몰려올 것 같은 스멜이.. 스멀스멀..<br/>

특히, 개발을 시작한지 얼마 안된 쥬니어들.. 나혼자 덩그러니 남겨진 사무실에서 장애가 발생했다 생각해보세요.. 덜덜덜 <br/>
 
분명, 장애는 짜증나기도 두려운 존재이기도 하지만 관점을 달리해볼 수는 없을까요? <br/>

저는 최근 이슈를 확인하고 해결하는 과정을 통해서 에러를 대하는 태도에 작은 변화가 있었습니다. (아주 작은! 작디 작습니다.)<br/>
(정말 부끄럽지만) 과정을 공유하고 그 안에서 제가 무엇을 느꼈는지 나눠볼까 합니다.<br/>

다만, 우려가 되는 부분은 우리 모두 다 각자 처한 상황과 환경이 다르기 때문에 분명 제 의견에 공감이 되지 않는 분들도 있을겁니다.<br/> 
감안하여 읽어주십사 부탁 드립니다. 이건 어디까지나 개인의 성장일기이니까요 :)

## 에러발생
어느 주말 오전 (주말에 장애라니.. ㄷㄷㄷ), 배민라이더스에서 주문이 되지 않는 다는 제보를 받았습니다.<br/>
(배달의민족에는 배달이 되지 않는 맛집 업소의 음식을 배달대행해주는 배민라이더스라는 서비스가 있다는 것 다들 아시죠?)<br/>
마침 동료 결혼식이 회사 근처라 이동중이어서 회사로 출근해서 살펴보기로 했습니다.

![error_capture]({{ site.url }}/img/2017-03-04/junior_01.jpg){: style="width:30%; display:block; border:1px solid #021a40; margin:20px auto 0;"}
*[괜찮아! 비록 제보자가 대표님 지인일지라도.. 침착하자.. 침착하자.. 침착하자..]*{: style="display:block;margin-top:10px;color:#828282;font-style:normal;text-align:center"}
 
에러가 발생한 상황은 명확했습니다. <br/>
* CI (우아한형제들에서는 PHP 프레임워크로 코드이그나이터를 사용하고 있습니다.) 세션에 저장된 키에 대한 값이 존재하지 않음
* 본인인증 후, 주문 프로세스로 넘어가지 않음 <br/>
* 본인인증을 하지 않은 사용자는 문제 없음<br/>

## 시간이 흐른뒤 (As Time Goes By)
회사에 도착하자마자 한 것이 "테스트환경에서 이슈재현" 이었습니다.<br/>
보아하니 인증단계가 문제가 된 것 같으니 두눈으로 확인해봐야겠다 생각했습니다.<br/> 
(만에하나 같은 상황에서 동일 이슈가 재현되지 않으면 다른 부분을 의심해봐야 했을테니까요! 음.. 좋았어!)
 
![by the way]({{ site.url }}/img/2017-03-04/junior_02.jpg){: style="width:55%; display:block; solid #021a40; margin:20px auto 0;"}

어제 저녁까지만해도 문제가 없었던 부분에서 에러가 나기 시작합니다.(다들.. 이런경험 한 번씩은 있으시쥬?)<br/>
시계는 째깍째깍 움직이고 있는데 (국방부 시계가 이렇게만 움직였다면...) 정작 테스트가 필요한 곳 근처에도 가지 못하게 된 채로 시간을 허비하였습니다.<br/>
설상가상으로 이슈 재현을 위해서 당일 결혼식 주인공의 도움이 필요했죠.. (차마 연락할 수도 없고..) <br/>
결국.. 현재 상황에서 이슈재현은 불가!

## 절대 현혹되지 마라
이미 밖은 어둑해졌고.. 상황이 진전된 것은 아무것도 없었습니다. 
![Feel irritable]({{ site.url }}/img/2017-03-04/junior_04.jpg){: style="width:55%; display:block; border:1px solid #021a40; margin:20px auto 0;"}

분명한 것은 'A서버에서 B서버를 다녀오면 세션 데이터가 사라진다' 였는데요, 무엇부터 확인을 해야할지 감이 도통 잡히지 않았습니다.<br/>
여러 궤변을 늘어놓으면서 동료들과 논의도 하고 구글링도 해봤습니다.<br/>
아침부터 삽질을 하며.. 이미 뇌는 멈추고, 정상적인 사고를 할 수 없는 그 때에!!(밑밥깔기..)<br/>
"라이더스 서버 2대로 운영하고 있자나요.." 라는 말에.. 떡밥을 덥석!! 물어버렸습니다.<br/>
사실, 말이 되지 않는다고 생각하면서도 뭔가.. 그때는 왜 그말에 현혹이 되어 버렸는지.. (아무래도 집에 가고 싶었던 마음이 컸던 모양입니다.)<br/>

## 부끄러움은 나의 몫
이미 뇌가 지배당한 상태에서 이사님께 보고를 드렸습니다. <br/>
음.. 그리고는 아래 보시는 것과 같이 되었죠 :) <br/>
절망적인 순간이었습니다..

![...]({{ site.url }}/img/2017-03-04/junior_05.png){: style="width:60%; display:block; solid #021a40; margin:20px auto 0;"}

이 과정을 복기하고 또 복기하면서 그당시 제가 범한 오류를 정리해봤습니다.
* 이슈를 재현하는 것에만 집착한 나머지 문제 해결에 대한 시야를 잃었다.
* 세션의 동작원리에 대해 정확히 알지 못했다. (결과적으로 이 이슈는 세션의 문제가 아니었습니다만..)
* CI세션 라이브러리의 동작원리에 대해 파악하려 하지 않았다.<br/>

이렇게 찜찜하게 마무리하고 주말 내내 세션, 쿠키에 대해 찾아보고 공부했습니다.<br/> 
그리고 빨리 월요일이 되어 반드시 원인을 찾아보겠노라고 전의를 불태웠죠!

## 문제적 원인
이슈재현과 로그까지 찍어보며 세션데이터가 지워진다 것을 재확인했지만<br/> 
결과적으로, CI세션의 동작원리에 대해 명확한 이해가 없었던 것이 핵심이었습니다.<br/>

정확하게는 아래 부분이 문제가 되었었습니다.

1. 인증서버와 주문서버간 코드이그나이터 세션 클래스의 설정값(sess_encrypt_cookie) 상이 
2. 해당 설정값은 아래와 같으며 쿠키 저장 및 읽기시 데이터 암복호화 여부와 관련
3. 추가적으로 저희가 사용하고 있는 CI는 2.X 버전으로 해당 버전에서는 세션을 쿠키에 저장 (결과적으로 세션이 아닌 쿠키에 저장하고 있음)

이번에는 코드에서 문제점을 명확하게 파악할 수 있었습니다. <br/>
그리고 왜 이슈가 발생했는지에 대해서도 제 스스로 납득할 수 있었고 다른 분들에게도 명확한 근거를 바탕으로 공유할 수 있었습니다.<br/>
뿐만아니라 세션과 쿠키에 대한 개념도 다시 한번 정립할 수 있었죠.<br/>

아래 링크에는 쿠키와 세션에 대한 간략한 정리가 있습니다.<br/>
이 글은 최근 안드로이드 개발에서 서버사이드 개발로 전향한 김민국님께서 작성해주셨습니다.<br/>
민국님 역시 개발인턴 출신이고 현재는 저와 같이 주문시스템 개발을 담당하고 있습니다. <br/>
* [쿠키와 세션에 대해 알아보자](https://cinabrosite.wordpress.com/2017/01/24/cookie_session/)

## 후기
저는 이번 에러를 해결하는 과정에서 스스로 부족한 부분을 많이 느꼈습니다.
* 장애인지 후 이틀이나 지나 문제를 해결했고
* 명확하게 파악하지 않은 정보를 보고하였고
* 이슈재현에만 집착하고 실제 동작하는 코드를 살펴보지 않았습니다.

그렇지만 그중 가장은, 스스로가 원인과 해결책을 납득하지 못했다는 것이겠지요.<br/>
(무식한 것을 용서받을 수 있는 것은 아니지만, 또 그 나름의 경험과 지식안에서 추측해볼 수 있는 전부이지 않았을까.. 하는 변명을..)

음.. 글이 잘 정리되었는지 모르겠지만, 제가 말하고 싶은 것은 "에러를 통해서도 우리는 성장할 수 있다"입니다.<br/>
물론, 우리네 현실은 쏟아지는 운영업무와 밀려드는 신규 개발 속에 있지만<br/>
그 과정이 성장의 밑거름이 될지.. 그냥 사태를 수습하는 것에 그치고 말 것인지는 어찌보면 스스로 선택할 수 있는 것 아닐까요?<br/>








 











